version: '3.8'

services:
  openclaw-gateway:
    build:
      context: .
      dockerfile: Dockerfile
    image: openclaw-local:latest
    container_name: openclaw-gateway
    hostname: openclaw-gateway
    
    environment:
      HOME: /home/node
      TERM: xterm-256color
      NODE_ENV: production
      
      # Gateway & Auth
      OPENCLAW_GATEWAY_TOKEN: ${OPENCLAW_GATEWAY_TOKEN}
      
      # OpenRouter
      OPENROUTER_API_KEY: ${OPENROUTER_API_KEY}
      DEFAULT_MODEL: ${DEFAULT_MODEL:-openrouter/deepseek/deepseek-v3.2}
      
      # Budget
      DAILY_BUDGET_USD: ${DAILY_BUDGET_USD:-2.0}
      
      # Sandbox
      SANDBOX_ENABLED: ${SANDBOX_ENABLED:-true}
      SANDBOX_MODE: ${SANDBOX_MODE:-non-main}
      
      # Logging
      LOG_LEVEL: ${LOG_LEVEL:-info}
    
    volumes:
      - openclaw_data:/home/node/.openclaw
      - /var/run/docker.sock:/var/run/docker.sock:ro
    
    ports:
      - "18789:18789"
      - "18790:18790"
    
    restart: unless-stopped
    init: true
    
    command:
      - "node"
      - "dist/index.js"
      - "gateway"
      - "--bind"
      - "0.0.0.0"
      - "--port"
      - "18789"

volumes:
  openclaw_data:
    driver: local

networks:
  default:
    driver: bridge
